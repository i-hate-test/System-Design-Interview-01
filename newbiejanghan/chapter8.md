# URL 단축기 설계
## 리디렉션
### Location in HTTP Header
리디렉션할 경로는 header 의 location 필드에 담아서 보내준다.

### 301 Permanently Moved VS. 302 Found
**301**  
해당 url 에 대한 HTTP 요청의 책임이 location 의 url 로 영구적으로 이전되었음을 의미.   
브라우저는 이 응답을 캐싱하게 되며, 단축 URL 요청은 location 의 URL 로 바로 이동한다.

**302**  
해당 url 에 대한 HTTP 요청이 일시적으로 location 의 url 에 의해 처리됨을 의미.  
캐싱은 없고 언제나 단축 URL 서버로 요청이 먼저 도달한다.

~~~~
301은 단축 url 서버의 부하를 줄여서 성능상 이점.
302는 트래픽 분석, 발생 위치 추적에 유리.
~~~~

## URL 단축
### 해시 함수
```
잘 알려진 해시 함수로는 CRS32, MD5, SHA-1 등이 있다.
가장 짧은 CRS32도 8자리수. 
만약 요구 사항에 따라 8자리수 미만으로도 충분하다면 해시 함수를 최적화하는 기술이 필요하다.
```
**해시 후 충돌 해소**  
만약 해시 8자리 중 7자리만 이용하기로 한다면 해시 값의 충돌이 발생할 수 있다.
충돌 여부를 확인하는 전략으로 DB에 조회하는 방법과 블룸 필터를 이용하는 방법이 있다.
충돌하는 값이 발견되면 기존 url 에 정해둔 문자열을 덧붙여 다시 해시한다.

**base-62 변환**  
uri 로 쓰이는 문자 개수가 62개(0-9, a-Z)라는 점을 이용하여 62진수 변환법을 사용할 수 있다.  
기존 url 을 db에 저장하고 id 값을 정수로 가지도록 한 다음 해당 정수를 62진수로 변환하는 방식이다.  
따라서 id 유일성을 보장하는 전략이 필요하다. => 7장 참고 필요  
또한 id 증가 전략을 이용해 다음 url 을 예측할 수 있다.  

